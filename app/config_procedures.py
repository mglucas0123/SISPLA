from typing import List, Dict

PROCEDURES: List[Dict[str, str]] = [
    {"code": "0401020100", "description": "APENDICECTOMIA"},
    {"code": "0401010048", "description": "COLECISTECTOMIA"},
    {"code": "0401010056", "description": "HERNIOPLASTIA INGUINAL"},
    {"code": "0407030026", "description": "COLECISTECTOMIA"},
    {"code": "0407030034", "description": "COLECISTECTOMIA VIDEOLAPAROSCOPICA"},
    {"code": "0407030133", "description": "ESPLENECTOMIA"},
    {"code": "0409050083", "description": "POSTECTOMIA"},
    {"code": "0409060135", "description": "HISTERECTOMIA TOTAL"},
    {"code": "0409060216", "description": "OOFORECTOMIA / OOFOROPLASTIA"},
    {"code": "0409060232", "description": "SALPINGECTOMIA UNI / BILATERAL"},
    {"code": "0409070149", "description": "EXERESE DE CISTO VAGINAL"},
    {"code": "0409070157", "description": "EXERESE DE GLANDULA DE BARTHOLIN / SKENE"},
    {"code": "0411010034", "description": "PARTO CESARIANO"},
    {"code": "0411020033", "description": "CURETAGEM POS-ABORTAMENTO / PUERPERAL"},
    {"code": "0411030030", "description": "HISTERECTOMIA PUERPERAL"},
    {"code": "0411040084", "description": "TRATAMENTO CIRURGICO DE GRAVIDEZ ECTOPICA"},
    {"code": "0413090119", "description": "RECONSTRUCAO DE LOBULO DA ORELHA"},
    {"code": "0415040027", "description": "DEBRIDAMENTO DE FASCITE NECROTIZANTE"},
    {"code": "0415040035", "description": "DEBRIDAMENTO DE ULCERA / TECIDOS DESVITALIZADOS"},
    {"code": "0415040043", "description": "DEBRIDAMENTO DE ULCERA / NECROSE"},
    {"code": "0401020177", "description": "CIRURGIA DE UNHA (CANTOPLASTIA)"},
    {"code": "0401020185", "description": "EXTIRPACAO SUPRESSAO DE LESAO DE PELE E DE TECIDO CELULAR SUBCUTANEO (VERRUGA)"},
    {"code": "0401010045", "description": "EXCISAO E ENXERTO DE PELE (HEMANGIOMA, NEVUS OU TUMOR)"},
    {"code": "0401020205", "description": "RETIRADA DE LESAO POR SHAVING"},
    {"code": "0401030028", "description": "FRENECTOMIA/FRENOTOMIA"},
    {"code": "0401010074", "description": "EXERESE DE TUMOR DE PELE E ANEXOS / CISTO SEBACEO / LIPOMA"},
    {"code": "0401010082", "description": "EXERESE DE LESAO E/OU SUTURA DE FERIMENTO DA PELE ANEXOS E MUCOSA"},
    {"code": "0401010037", "description": "ELETROCOAGULACAO DE LESAO CUTANEA"},
    {"code": "0401010053", "description": "BIOPSIA DE PELE"},
    {"code": "0309070015", "description": "TRATAMENTO ESCLEROSANTE NAO ESTETICO DE VARIZES DOS MEMBROS INFERIORES (UNILATERAL)"},
    {"code": "0309070023", "description": "TRATAMENTO ESCLEROSANTE NAO ESTETICO DE VARIZES DOS MEMBROS INFERIORES (BILATERAL)"},
    {"code": "0401010090", "description": "EXERESE DE NODULO DE MAMA"},
    {"code": "0401010104", "description": "BIOPSIA DE TIREOIDE OU PARATIREOIDE - PAAF"},
    {"code": "0401010112", "description": "BIOPSIA DE PELE E PARTES MOLES"},
    {"code": "0401020010", "description": "BIOPSIA / PUNCAO DE TUMOR SUPERFICIAL DA PELE"},
    {"code": "0401030044", "description": "RETIRADA DO DISPOSITIVO INTRA-UTERINO (DIU)"},
    {"code": "0401030052", "description": "COLOCACAO DE DISPOSITIVO INTRA-UTERINO (DIU)"},
    {"code": "0401020150", "description": "INCISAO E DRENAGEM DE ABSCESSO"},
    {"code": "0401010029", "description": "CURETAGEM DE LESAO E/OU SUTURA DE LESAO CUTANEA"},
    {"code": "0401010061", "description": "EXERESE DE LESAO E/OU SUTURA SIMPLES DE PEQUENAS LESOES / FERIMENTOS DE PELE / ANEXOS E MUCOSA"},
    {"code": "0401020193", "description": "CAUTERIZACAO QUIMICA DE LESOES CUTANEAS"},
    {"code": "0401010139", "description": "TRATAMENTO DO CORPO ESTRANHO SUBCUTANEO"},
    {"code": "0401010120", "description": "RETIRADA DE LESAO POR SHAVING"},
    {"code": "0401010147", "description": "TRATAMENTO CIRURGICO DE FISTULA DO PESCOCO (POR APROXIMACAO)"},
    {"code": "0401020066", "description": "EXERESE DE CISTO DERMOIDE"},
    {"code": "0401020074", "description": "EXERESE DE CISTO EPIDERMICO"},
    {"code": "0401020082", "description": "EXERESE DE CISTO DE PELE TOTAL"},
    {"code": "0401020090", "description": "EXERESE DE CISTO BRANQUIAL"},
    {"code": "0401020104", "description": "EXERESE DE CISTO DERMOIDE"},
    {"code": "0401020112", "description": "EXERESE DE CISTO SACRO-COCCIGEO (PILONIDAL)"},
    {"code": "0401020120", "description": "EXERESE DE CISTO TIREOGLOSSO"},
    {"code": "04050097", "description": "FACECTOMIA COM IMPLANTE DE LENTE INTRA-OCULAR"},
    {"code": "04060011", "description": "TRATAMENTO CIRURGICO DE VARIZES (BILATERAL)"},
    {"code": "04060020", "description": "TRATAMENTO CIRURGICO DE VARIZES (UNILATERAL)"},
    {"code": "04060038", "description": "GASTROSTOMIA"},
    {"code": "04070026", "description": "HEMORRIDECTOMIA"},
    {"code": "04070026", "description": "HERNIORRAFIA COM RESSECCAO INTESTINAL (HERNIA ESTRANGULADA)"},
]

def search_procedures(query: str, limit: int = 15) -> List[Dict[str, str]]:
    if not query:
        return []
    q = query.strip().lower()
    results = [p for p in PROCEDURES if q in p["code"].lower() or q in p["description"].lower()]
    return results[:limit]
