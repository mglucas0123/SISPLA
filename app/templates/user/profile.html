{% extends "navbar.html" %}

{% block title %}Meu Perfil | SISPLA{% endblock %}

{% block styles %}
{% endblock %}

{% block content %}
{% include 'partials/_flash_messages.html' %}
<div class="profile-page">
    <aside class="profile-sidebar">
        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-title">Menu Principal</div>
                <div class="nav-item">
                    <a href="#" class="nav-link active" data-section="perfil">
                        <span class="nav-icon"><i class="bi bi-person"></i></span>
                        <span class="nav-text">Meu Perfil</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="seguranca">
                        <span class="nav-icon"><i class="bi bi-shield-lock"></i></span>
                        <span class="nav-text">Segurança</span>
                    </a>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Navegação</div>
                <div class="nav-item">
                    <a href="{{ url_for('main.panel') }}" class="nav-link">
                        <span class="nav-icon"><i class="bi bi-house"></i></span>
                        <span class="nav-text">Voltar ao Início</span>
                    </a>
                </div>
            </div>
        </nav>

        <div class="sidebar-user">
            <div class="user-info">
                <div class="user-avatar">
                    <i class="bi bi-person-fill"></i>
                </div>
                <div class="user-details">
                    <div class="user-name text-center">{{ current_user.name }}</div>
                    <div class="user-email text-center">{{ current_user.email }}</div>
                </div>
            </div>
        </div>
    </aside>

    <main class="profile-content">
        {% include 'user/profile/modules/_section_perfil.html' %}

        {% include 'user/profile/modules/_section_seguranca.html' %}
    </main>
</div>

{# Script de navegação entre seções #}
<script>
document.addEventListener('DOMContentLoaded', function () {
    const navLinks = document.querySelectorAll('.sidebar-nav .nav-link[data-section]');
    const sections = document.querySelectorAll('.profile-section');

    function showSection(sectionId) {
        sections.forEach(s => s.classList.remove('active'));

        const targetSection = document.getElementById('section-' + sectionId);
        if (targetSection) {
            targetSection.classList.add('active');
        }

        navLinks.forEach(l => l.classList.remove('active'));
        const activeLink = document.querySelector(`[data-section="${sectionId}"]`);
        if (activeLink) {
            activeLink.classList.add('active');
        }
    }

    navLinks.forEach(link => {
        link.addEventListener('click', function (e) {
            e.preventDefault();
            const sectionId = this.getAttribute('data-section');
            showSection(sectionId);
        });
    });
});
</script>
{% endblock %}